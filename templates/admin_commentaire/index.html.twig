{% extends 'base.html.twig' %}

{% block title %}Gestion des Commentaires
{% endblock %}

{% block body %}
	<div class="container mt-4">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h1>Mod√©ration des Commentaires</h1>
			<a href="{{ path('app_admin') }}" class="btn btn-outline-secondary">
				<i class="fa-solid fa-arrow-left"></i>
				Retour Dashboard
			</a>
		</div>

		<div class="card shadow-sm">
			<div class="card-body p-0">
				<div class="table-responsive">
					<table class="table table-striped table-hover mb-0 align-middle">
						<thead class="table-light">
							<tr>
								<th>ID</th>
								<th>Auteur</th>
								<th>Message</th>
								<th>Date</th>
								<th>Type</th>
								<th class="text-end">Actions</th>
							</tr>
						</thead>
						<tbody>
							{# üëá ICI : On boucle sur 'commentaires' (pluriel) pour cr√©er la variable 'comm' (singulier) #}
							{% for comm in commentaires %}
								<tr>
									<td>{{ comm.id }}</td>
									<td>
										<strong>{{ comm.user.name ?? 'Anonyme' }}</strong><br>
										<small class="text-muted">{{ comm.user.email ?? '' }}</small>
									</td>
									<td>
										{{ comm.text|length > 50 ? comm.text|slice(0, 50) ~ '...' : comm.text }}
									</td>
									<td>{{ comm.date ? comm.date|date('d/m/Y H:i') : '' }}</td>
									<td>
										{% if comm.typeCommentaire == 'experience' %}
											<span class="badge bg-success">Exp√©rience</span>
										{% else %}
											<span class="badge bg-info text-dark">Aide</span>
										{% endif %}
									</td>
									<td class="text-end">
										<div class="btn-group">
											<a href="{{ path('app_admin_commentaire_show', {'id': comm.id}) }}" class="btn btn-sm btn-info text-white">
												<i class="fa-solid fa-eye"></i>
											</a>
											<a href="{{ path('app_admin_commentaire_edit', {'id': comm.id}) }}" class="btn btn-sm btn-warning">
												<i class="fa-solid fa-pen"></i>
											</a>

											<form method="post" action="{{ path('app_admin_commentaire_delete', {'id': comm.id}) }}" style="display: inline-block;" onsubmit="return confirm('Voulez-vous vraiment supprimer ce commentaire ?');">
												<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ comm.id) }}">
												<button class="btn btn-sm btn-danger">
													<i class="fa-solid fa-trash"></i>
												</button>
											</form>
										</div>
									</td>
								</tr>
							{% else %}
								<tr>
									<td colspan="6" class="text-center py-4">Aucun commentaire trouv√©.</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
